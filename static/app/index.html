<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Grouphone</title>

    <script src="../module/webcomponentsjs/webcomponents.min.js"></script>
    <script src="../module/angular/angular.js"></script>
    <script src="../module/angular-route/angular-route.js"></script>

    <link rel="import" href="../module/font-roboto/roboto.html">
    <link rel="import" href="../module/core-field/core-field.html">
    <link rel="import" href="../module/core-icons/core-icons.html">
    <link rel="import" href="../module/core-icons/av-icons.html">
    <link rel="import" href="../module/core-icons/image-icons.html">
    <link rel="import" href="../module/core-icons/social-icons.html">
    <link rel="import" href="../module/core-icons/communication-icons.html">
    <link rel="import" href="../module/core-toolbar/core-toolbar.html">
    <link rel="import" href="../module/core-media-query/core-media-query.html">
    <link rel="import" href="../module/paper-fab/paper-fab.html">
    <link rel="import" href="../module/paper-item/paper-item.html">
    <link rel="import" href="../module/paper-button/paper-button.html">
    <link rel="import" href="../module/paper-icon-button/paper-icon-button.html">

    <link rel="stylesheet" href="../css/override.css">
    <link rel="stylesheet" href="../css/app.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Alegreya+Sans:300,700,300italic" />

    <script>
      var grouphone = angular.module("grouphone", ["ngRoute"]);

      grouphone.config(['$routeProvider', function($routeProvider) {
        $routeProvider
          .when("/", { templateUrl: "app.html", controller: "gpAppCtrl" })
          .when("/call", { templateUrl: "call.html", controller: "gpCallCtrl" })
          .when("/join/:id", { templateUrl: "call.html", controller: "gpJoinCtrl" })
          .when("/login", { templateUrl: "login.html", controller: "gpLoginCtrl" })
          .otherwise({ redirectTo: "/"});
      }])

      grouphone.controller("gpAppCtrl", function ($scope, $http) {
        document.getElementById("trigger").addEventListener("click", function (e) {
          location.assign("#/call");
        }, true);
      })
      grouphone.controller("gpCallCtrl", function ($scope) {
        initcall();
        document.getElementById("disconnect").addEventListener("click", function (e) {
          if (room) room.disconnect();
          location.assign("#/");
        }, true);
      })
       grouphone.controller("gpJoinCtrl", function ($scope, $routeParams) {
        if ($routeParams.id) initcall($routeParams.id);
        document.getElementById("disconnect").addEventListener("click", function (e) {
          if (room) room.disconnect();
          location.assign("#/");
        }, true);
      })
      grouphone.controller("gpLoginCtrl", function ($scope) {
        document.getElementById("login").addEventListener("click", function (e) {
          location.assign("#/");
        }, true);
      })
    </script>

  </head>

  <body unresolved ng-app="grouphone">

    <core-toolbar style="background: #ff4e00;">
      <paper-icon-button icon="menu"></paper-icon-button>
      <span flex>Grouphone</span>
    </core-toolbar>

    <div class="content groups" ng-view></div>

    <script src="../js/vendor/erizo.js"></script>
    <script src="../js/call.js"></script>

  </body>

</html>
